// 2025-08-27 09:05:36
#include <iostream>
#include <algorithm>
#include <vector>
#include <utility>

using namespace std;

//ç»™ä½ ä¸€ä¸ªå¤§å°ä¸º n x m çš„äºŒç»´æ•´æ•°çŸ©é˜µ gridï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ çš„å€¼ä¸º 0ã€1 æˆ– 2ã€‚
//
// V å½¢å¯¹è§’çº¿æ®µ å®šä¹‰å¦‚ä¸‹ï¼š
//
//
// çº¿æ®µä» 1 å¼€å§‹ã€‚
// åç»­å…ƒç´ æŒ‰ç…§ä»¥ä¸‹æ— é™åºåˆ—çš„æ¨¡å¼æ’åˆ—ï¼š2, 0, 2, 0, ...ã€‚
// è¯¥çº¿æ®µï¼š
//
// èµ·å§‹äºæŸä¸ªå¯¹è§’æ–¹å‘ï¼ˆå·¦ä¸Šåˆ°å³ä¸‹ã€å³ä¸‹åˆ°å·¦ä¸Šã€å³ä¸Šåˆ°å·¦ä¸‹æˆ–å·¦ä¸‹åˆ°å³ä¸Šï¼‰ã€‚
// æ²¿ç€ç›¸åŒçš„å¯¹è§’æ–¹å‘ç»§ç»­ï¼Œä¿æŒ åºåˆ—æ¨¡å¼ ã€‚
// åœ¨ä¿æŒ åºåˆ—æ¨¡å¼ çš„å‰æä¸‹ï¼Œæœ€å¤šå…è®¸ ä¸€æ¬¡é¡ºæ—¶é’ˆ 90 åº¦è½¬å‘ å¦ä¸€ä¸ªå¯¹è§’æ–¹å‘ã€‚
//
//
//
//
//
// è¿”å›æœ€é•¿çš„ V å½¢å¯¹è§’çº¿æ®µ çš„ é•¿åº¦ ã€‚å¦‚æœä¸å­˜åœ¨æœ‰æ•ˆçš„çº¿æ®µï¼Œåˆ™è¿”å› 0ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
// è¾“å…¥ï¼š grid = [[2,2,1,2,2],[2,0,2,2,0],[2,0,1,1,0],[1,0,2,2,2],[2,0,0,2,2]]
//
//
// è¾“å‡ºï¼š 5
//
// è§£é‡Šï¼š
//
//
//
// æœ€é•¿çš„ V å½¢å¯¹è§’çº¿æ®µé•¿åº¦ä¸º 5ï¼Œè·¯å¾„å¦‚ä¸‹ï¼š(0,2) â†’ (1,3) â†’ (2,4)ï¼Œåœ¨ (2,4) å¤„è¿›è¡Œ é¡ºæ—¶é’ˆ 90 åº¦è½¬å‘ ï¼Œç»§ç»­è·¯å¾„ä¸º (3,
//3) â†’ (4,2)ã€‚
//
// ç¤ºä¾‹ 2ï¼š
//
//
// è¾“å…¥ï¼š grid = [[2,2,2,2,2],[2,0,2,2,0],[2,0,1,1,0],[1,0,2,2,2],[2,0,0,2,2]]
//
//
// è¾“å‡ºï¼š 4
//
// è§£é‡Šï¼š
//
//
//
// æœ€é•¿çš„ V å½¢å¯¹è§’çº¿æ®µé•¿åº¦ä¸º 4ï¼Œè·¯å¾„å¦‚ä¸‹ï¼š(2,3) â†’ (3,2)ï¼Œåœ¨ (3,2) å¤„è¿›è¡Œ é¡ºæ—¶é’ˆ 90 åº¦è½¬å‘ ï¼Œç»§ç»­è·¯å¾„ä¸º (2,1) â†’ (1,
//0)ã€‚
//
// ç¤ºä¾‹ 3ï¼š
//
//
// è¾“å…¥ï¼š grid = [[1,2,2,2,2],[2,2,2,2,0],[2,0,0,0,0],[0,0,2,2,2],[2,0,0,2,0]]
//
//
// è¾“å‡ºï¼š 5
//
// è§£é‡Šï¼š
//
//
//
// æœ€é•¿çš„ V å½¢å¯¹è§’çº¿æ®µé•¿åº¦ä¸º 5ï¼Œè·¯å¾„å¦‚ä¸‹ï¼š(0,0) â†’ (1,1) â†’ (2,2) â†’ (3,3) â†’ (4,4)ã€‚
//
// ç¤ºä¾‹ 4ï¼š
//
//
// è¾“å…¥ï¼š grid = [[1]]
//
//
// è¾“å‡ºï¼š 1
//
// è§£é‡Šï¼š
//
// æœ€é•¿çš„ V å½¢å¯¹è§’çº¿æ®µé•¿åº¦ä¸º 1ï¼Œè·¯å¾„å¦‚ä¸‹ï¼š(0,0)ã€‚
//
//
//
// æç¤ºï¼š
//
//
// n == grid.length
// m == grid[i].length
// 1 <= n, m <= 500
// grid[i][j] çš„å€¼ä¸º 0ã€1 æˆ– 2ã€‚
//
//
// Related Topics è®°å¿†åŒ–æœç´¢ æ•°ç»„ åŠ¨æ€è§„åˆ’ çŸ©é˜µ ğŸ‘ 6 ğŸ‘ 0


//leetcode submit region begin(Prohibit modification and deletion)
class Solution {
private:
    vector<int> move{-1, 1, 1, -1, -1};
    int n, m;
public:
    int dfs(int r, int c, int direc, int step, vector<vector<int>>& grid) {
        // è¾¹ç•Œæ¡ä»¶é€€å‡º
        if (r < 0 || r >= n || c < 0 || c >= m) return 0;
        if (!(step & 1) && (grid[r][c] != 2)) return 0; // step ä¸ºå¶æ•°æ—¶,grid[r][c]å¿…é¡»ä¸º2
        if ((step & 1) && (grid[r][c] != 0)) return 0; // step ä¸ºå¥‡æ•°æ—¶,grid[r][c]å¿…é¡»ä¸º0

        int origin_ = dfs(r + move[direc], c + move[direc + 1], direc, step + 1, grid);
        direc = (direc + 1) % 4;
        int rotate_ = dfs(r + move[direc], c + move[direc + 1], direc, step + 1, grid);
        direc = (direc - 1 + 4) % 4;
        return max(origin_, rotate_) + 1;
    }

    int lenOfVDiagonal(vector<vector<int>>& grid) {
        n = grid.size(), m = grid[0].size();
        int ans = 0;
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                if (grid[i][j] == 1) { // å¦‚æœæ­¤æ—¶ä¸ºä¸€,åˆ™æœå››ä¸ªæ–¹å‘å¼€å§‹dfs
                    for (int k = 0; k < 4; k++) {
                        ans = max(ans, dfs(i + move[k], j + move[k + 1], k, 0, grid) + 1);
                    }
                }
            }
        }
        return ans;
    }
};
//leetcode submit region end(Prohibit modification and deletion)

int main() {
    vector<vector<int>> nums = {{2,2,1,2,2},{2,0,2,2,0},{2,0,1,1,0},{1,0,2,2,2},{2,0,0,2,2}};
    Solution().lenOfVDiagonal(nums);
}